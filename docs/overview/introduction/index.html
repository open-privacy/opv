<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preload as=font href=/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><link rel=stylesheet href=/main.d1a5b296d88aac5b98518f48eed84503a2016490676b125de763d35a192fd97bdab9c73f251ea169d3bdd39162503d879e957080bba9030e0047187a90981b40.css integrity="sha512-0aWyltiKrFuYUY9I7thFA6IBZJBnaxJd52PTWhkv2Xvaucc/JR6hadO905FiUD2HnpVwgLupAw4ARxh6kJgbQA==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>1. Introduction - Open Privacy Vault</title><meta name=description content="Open Privacy Vault - Secure, Performant, Open Source PII as a Service."><link rel=canonical href=/docs/overview/introduction/><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="/opv.png"><meta name=twitter:title content="1. Introduction"><meta name=twitter:description content="Open Privacy Vault - Secure, Performant, Open Source PII as a Service."><meta name=twitter:site content="@openprivacy"><meta name=twitter:creator content="@openprivacy"><meta property="og:title" content="1. Introduction"><meta property="og:description" content="Open Privacy Vault - Secure, Performant, Open Source PII as a Service."><meta property="og:type" content="article"><meta property="og:url" content="/docs/overview/introduction/"><meta property="og:image" content="/opv.png"><meta property="og:site_name" content="Open Privacy Vault"><meta property="article:publisher" content="https://www.facebook.com/openprivacy"><meta property="article:author" content="https://www.facebook.com/openprivacy"><meta property="og:locale" content="en_US"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"\/"},{"@type":"ListItem","position":2,"name":"Docsoverviewintroduction","item":"\/docsoverviewintroduction\/"}]}</script><meta name=theme-color content="#fff"><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest></head><body class="docs single"><div class="header-bar fixed-top"></div><header class="navbar fixed-top navbar-expand-md navbar-light"><div class=container><input class="menu-btn order-0" type=checkbox id=menu-btn>
<label class="menu-icon d-md-none" for=menu-btn><span class=navicon></span></label><a class="navbar-brand order-1 order-md-0 mr-auto" href=/>Open Privacy Vault</a>
<button id=mode class="btn btn-link order-2 order-md-4" type=button aria-label="Toggle mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button><ul class="navbar-nav social-nav order-3 order-md-5"><li class=nav-item><a class=nav-link href=https://github.com/open-privacy/opv><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><span class="ml-2 sr-only">GitHub</span></a></li></ul><div class="collapse navbar-collapse order-4 order-md-1"><ul class="navbar-nav main-nav mr-auto order-5 order-md-2"><li class="nav-item active"><a class=nav-link href=/docs/overview/introduction/>Docs</a></li></ul><div class="break order-6 d-md-none"></div><form class="navbar-form flex-grow-1 order-7 order-md-3"><input id=userinput class="form-control is-search" type=search placeholder="Search docs..." aria-label="Search docs..." autocomplete=off><div id=suggestions class="shadow bg-white rounded"></div></form></div></div></header><div class="wrap container" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar"><nav class=docs-links aria-label="Main navigation"><h3>Overview</h3><ul class=list-unstyled><li><a class="docs-link active" href=/docs/overview/introduction/>1. Introduction</a></li><li><a class=docs-link href=/docs/overview/architecture/>2. Architecture</a></li><li><a class=docs-link href=/docs/overview/planes/>3. Planes</a></li><li><a class=docs-link href=/docs/overview/env/>4. Env Configuration</a></li><li><a class=docs-link href=/docs/overview/encryption/>5. Encryption</a></li><li><a class=docs-link href=/docs/overview/hash/>6. Hash</a></li><li><a class=docs-link href=/docs/overview/auth/>7. Auth</a></li><li><a class=docs-link href=/docs/overview/database/>8. Database</a></li><li><a class=docs-link href=/docs/overview/fact_types/>9. PII Fact Types</a></li></ul><h3>Development</h3><ul class=list-unstyled><li><a class=docs-link href=/docs/development/playground/>Playground</a></li><li><a class=docs-link href=/docs/development/dataplane_api/>Data Plane API</a></li><li><a class=docs-link href=/docs/development/controlplane_api/>Control Plane API</a></li><li><a class=docs-link href=/docs/development/proxyplane_config/>Proxy Plane Config</a></li><li><a class=docs-link href=/docs/development/source/>Working with Source Code</a></li><li><a class=docs-link href=/docs/development/faq/>FAQ</a></li></ul></nav></div><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=page-links><h3>On this page</h3><nav id=TableOfContents><ul><li><a href=#quick-start>Quick Start</a><ul><li><a href=#running-local-opv>Running Local OPV</a></li><li><a href=#apis>APIs</a></li></ul></li><li><a href=#performance>Performance</a><ul><li><a href=#endpoint-latency>Endpoint Latency</a></li><li><a href=#prometheus-monitoring>Prometheus Monitoring</a></li></ul></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9"><h1>1. Introduction</h1><p class=lead></p><p>Open Privacy Vault (OPV) - Secure, Performant, Open Source PII as a Service.
The goal of OPV is to provide an open standard of PII management. With Structural PII
validation, performant APIs, pluggable databases, extendabale encryption and hashing engine,
flexible policy and authorization, we are aiming to bring the highest open standard for
the fair usage of PII.</p><h2 id=quick-start>Quick Start<a href=#quick-start class=anchor aria-hidden=true>#</a></h2><h3 id=running-local-opv>Running Local OPV<a href=#running-local-opv class=anchor aria-hidden=true>#</a></h3><p>Note that all the configuration of OPV is done through environment variables.
For example, setting <code>OPV_DB_DRIVER=mysql</code>. See <a href=/docs/overview/env/>Env Configuration →</a>.</p><p>Start with docker.</p><div class=highlight><pre class=chroma><code class=language-sh data-lang=sh><span class=c1># Control Plane</span>

docker run -it <span class=se>\
</span><span class=se></span>  -v /tmp/opv_data:/data <span class=se>\
</span><span class=se></span>  -p 27999:27999 <span class=se>\
</span><span class=se></span>  openprivacyio/opv <span class=se>\
</span><span class=se></span>  controlplane
</code></pre></div><div class=highlight><pre class=chroma><code class=language-sh data-lang=sh><span class=c1># Data Plane</span>

docker run -it <span class=se>\
</span><span class=se></span>  -v /tmp/opv_data:/data <span class=se>\
</span><span class=se></span>  -p 28000:28000 <span class=se>\
</span><span class=se></span>  openprivacyio/opv <span class=se>\
</span><span class=se></span>  dataplane
</code></pre></div><div class=highlight><pre class=chroma><code class=language-sh data-lang=sh><span class=c1># Proxy Plane (Depends on Data Plane, and a grant token created from Control Plane)</span>

docker run -it <span class=se>\
</span><span class=se></span>  -v /tmp/opv_data:/data <span class=se>\
</span><span class=se></span>  -p 28001:28001 <span class=se>\
</span><span class=se></span>  -e <span class=nv>OPV_PROXY_PLANE_DEFAULT_DP_BASE_URL</span><span class=o>=</span><span class=s1>&#39;http://127.0.0.1:28000&#39;</span> <span class=se>\
</span><span class=se></span>  -e <span class=nv>OPV_PROXY_PLANE_DEFAULT_DP_GRANT_TOKEN</span><span class=o>=</span><span class=s1>&#39;grant_token_that_can_read_write_facts&#39;</span> <span class=se>\
</span><span class=se></span>  openprivacyio/opv <span class=se>\
</span><span class=se></span>  proxyplane
</code></pre></div><p>Start from source code:</p><div class=highlight><pre class=chroma><code class=language-sh data-lang=sh>git clone https://github.com/open-privacy/opv
<span class=nb>cd</span> opv
make vendor

<span class=c1># Start the control plane and data plane</span>
make run

<span class=c1># Start the proxyplane (optional)</span>
<span class=nv>OPV_PROXY_PLANE_DEFAULT_DP_GRANT_TOKEN</span><span class=o>=</span>&lt;grant_token_that_can_read_write_facts&gt; make run_proxyplane
</code></pre></div><p>Try it with the playground:</p><ul><li><a href=https://playground.openprivacy.io/swagger/index.html>https://playground.openprivacy.io/swagger/index.html</a></li><li>A testing domain <code>sandbox.example.com</code> grant token ( <code>v1:sandbox.example.com:Iy8TJZcuhicocCklFdwA</code> ) can be used to test the playground. It has the permission to access to all the paths and http methods of the dataplane within the domain of <code>sandbox.example.com</code>.</li></ul><div class=highlight><pre class=chroma><code class=language-json data-lang=json><span class=p>{</span>
  <span class=nt>&#34;token&#34;</span><span class=p>:</span> <span class=s2>&#34;v1:sandbox.example.com:Iy8TJZcuhicocCklFdwA&#34;</span><span class=p>,</span>
  <span class=nt>&#34;domain&#34;</span><span class=p>:</span> <span class=s2>&#34;sandbox.example.com&#34;</span><span class=p>,</span>
  <span class=nt>&#34;allowed_http_methods&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;*&#34;</span><span class=p>],</span>
  <span class=nt>&#34;paths&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;*&#34;</span><span class=p>]</span>
<span class=p>}</span>
</code></pre></div><img src=/images/dataplane_swagger.png class=img-fluid alt=arch.png><h3 id=apis>APIs<a href=#apis class=anchor aria-hidden=true>#</a></h3><p>For more information, please take a look at</p><ul><li><a href=/docs/development/dataplane_api/>Data Plane API →</a></li><li><a href=/docs/development/controlplane_api/>Control Plane API →</a></li><li><a href=/docs/development/proxyplane_config/>Proxy Plane Config →</a></li></ul><p>Now you can test the APIs with <code>curl</code>.</p><div class=highlight><pre class=chroma><code class=language-sh data-lang=sh><span class=c1># Create a new grant token from the control plane http://127.0.0.1:27999</span>

curl -X POST <span class=s1>&#39;http://127.0.0.1:27999/api/v1/grants&#39;</span> <span class=se>\
</span><span class=se></span>--header <span class=s1>&#39;Content-Type: application/json&#39;</span> <span class=se>\
</span><span class=se></span>--data-raw <span class=s1>&#39;{
</span><span class=s1>        &#34;allowed_http_methods&#34;: [&#34;*&#34;],
</span><span class=s1>        &#34;paths&#34;: [&#34;*&#34;],
</span><span class=s1>        &#34;domain&#34;: &#34;sandbox.example.com&#34;
</span><span class=s1>}&#39;</span>


<span class=c1># The response will give you a grant token for data plane access</span>
<span class=c1># You can pass the token via HTTP header X-OPV-GRANT-TOKEN</span>
<span class=o>{</span>
  <span class=s2>&#34;token&#34;</span>: <span class=s2>&#34;v1:sandbox.example.com:Iy8TJZcuhicocCklFdwA&#34;</span>,
  <span class=s2>&#34;domain&#34;</span>: <span class=s2>&#34;sandbox.example.com&#34;</span>,
  <span class=s2>&#34;allowed_http_methods&#34;</span>: <span class=o>[</span><span class=s2>&#34;*&#34;</span><span class=o>]</span>,
  <span class=s2>&#34;paths&#34;</span>: <span class=o>[</span><span class=s2>&#34;*&#34;</span><span class=o>]</span>
<span class=o>}</span>
</code></pre></div><div class=highlight><pre class=chroma><code class=language-sh data-lang=sh><span class=c1># Store a new fact by calling the data plane http://127.0.0.1:28000</span>
<span class=c1># Please replace the token with the token you just got above</span>

curl -X POST <span class=s1>&#39;http://127.0.0.1:28000/api/v1/facts&#39;</span> <span class=se>\
</span><span class=se></span>-H <span class=s1>&#39;Content-Type: application/json&#39;</span> <span class=se>\
</span><span class=se></span>-H <span class=s1>&#39;X-OPV-GRANT-TOKEN: v1:sandbox.example.com:Iy8TJZcuhicocCklFdwA&#39;</span> <span class=se>\
</span><span class=se></span>--data-raw <span class=s1>&#39;{
</span><span class=s1>        &#34;fact_type_slug&#34;: &#34;ssn&#34;,
</span><span class=s1>        &#34;value&#34;: &#34;123-45-6789&#34;
</span><span class=s1>}&#39;</span>
</code></pre></div><p>One can open the local swagger UI to test the APIs:</p><ul><li>Default Control Plane Swagger URL:<ul><li><a href=http://127.0.0.1:27999/swagger/index.html>http://127.0.0.1:27999/swagger/index.html</a></li></ul></li><li>Default Data Plane Swagger URL:<ul><li><a href=http://127.0.0.1:28000/swagger/index.html>http://127.0.0.1:28000/swagger/index.html</a></li></ul></li></ul><p>One can also test the proxyplane:</p><ul><li>Default Proxy Plane Port: <a href=http://127.0.0.1:28001>http://127.0.0.1:28001</a><ul><li>The routes of the proxy plane are defined at <a href=https://github.com/open-privacy/opv/blob/53eb70c1ce9aaaa897863982efb468df487ce7c0/cmd/proxyplane/opv-proxyplane-http.example.json#L105>opv-proxyplane-http.example.json</a>. Learn more at <a href=/docs/development/proxyplane_config/>Proxy Plane Config →</a>.</li></ul></li></ul><h2 id=performance>Performance<a href=#performance class=anchor aria-hidden=true>#</a></h2><h3 id=endpoint-latency>Endpoint Latency<a href=#endpoint-latency class=anchor aria-hidden=true>#</a></h3><p>We are expecting to see <code>P99 &lt; 10ms</code> latency when sending GET requests to <code>/api/v1/facts/:id</code>,
which is the most heavily used endpoint to retrieve PIIs from a tokinized <code>fact</code>. We did some simple
benchmarking (nowhere near perfert of course), to keep tracking the performance of the GET endpoints.</p><div class=highlight><pre class=chroma><code class=language-sh data-lang=sh><span class=cp>#!/bin/sh
</span><span class=cp></span>
<span class=c1># Make sure you have vegeta downlaoded. https://github.com/tsenart/vegeta</span>
<span class=c1># Replace the X-Opv-Grant-Token and fact_id for the benchmark script</span>

<span class=nb>echo</span> <span class=s1>$&#39;GET http://127.0.0.1:28000/api/v1/facts/fact_1LqMuvudjA1xdtqbjd0l \nX-Opv-Grant-Token: v1:sandbox.example.com:Iy8TJZcuhicocCklFdwA&#39;</span> <span class=se>\
</span><span class=se></span>    <span class=p>|</span> vegeta attack -duration<span class=o>=</span>10s <span class=p>|</span> vegeta report

<span class=c1># Example of the result</span>
<span class=c1># $ sh vegeta.sh</span>

<span class=c1># Requests      [total, rate, throughput]         500, 50.11, 50.11</span>
<span class=c1># Duration      [total, attack, wait]             9.978s, 9.977s, 1.17ms</span>
<span class=c1># Latencies     [min, mean, 50, 90, 95, 99, max]  753.995µs, 1.679ms, 1.415ms, 2.564ms, 3.061ms, 6.926ms, 12.096ms</span>
<span class=c1># Bytes In      [total, mean]                     62000, 124.00</span>
<span class=c1># Bytes Out     [total, mean]                     0, 0.00</span>
<span class=c1># Success       [ratio]                           100.00%</span>
<span class=c1># Status Codes  [code:count]                      200:500</span>
<span class=c1># Error Set:</span>
</code></pre></div><img src=/images/BenchmarkFlameGraph.png class=img-fluid alt=benchmark_flamegraph.png><h3 id=prometheus-monitoring>Prometheus Monitoring<a href=#prometheus-monitoring class=anchor aria-hidden=true>#</a></h3><p>By default, prometheus metrics are enabled for both data plane and control plane (controlled
by the environment variable <code>OPV_PROMETHEUS_ENABLED</code>). You can easily connect your prometheus
scraper with the following config:</p><div class=highlight><pre class=chroma><code class=language-yaml data-lang=yaml><span class=nt>scrape_configs</span><span class=p>:</span><span class=w>
</span><span class=w>  </span>- <span class=nt>job_name</span><span class=p>:</span><span class=w> </span><span class=l>opv-metrics</span><span class=w>
</span><span class=w>    </span><span class=nt>metrics_path</span><span class=p>:</span><span class=w> </span><span class=l>/metrics</span><span class=w>
</span><span class=w>    </span><span class=nt>static_configs</span><span class=p>:</span><span class=w>
</span><span class=w>      </span>- <span class=nt>targets</span><span class=p>:</span><span class=w>
</span><span class=w>          </span>- <span class=s2>&#34;opv_controlplane:27999&#34;</span><span class=w>   </span><span class=c># replace it with the actual controlplane&#39;s base URL</span><span class=w>
</span><span class=w>          </span>- <span class=s2>&#34;opv_dataplane:28000&#34;</span><span class=w>      </span><span class=c># replace it with the actual dataplane&#39;s base URL</span><span class=w>
</span></code></pre></div><p>For local benchmarking, we created a docker-compose network to test the prometheus and grafana,
and we can closely monitor the performance regression.</p><div class=highlight><pre class=chroma><code class=language-sh data-lang=sh><span class=nb>cd</span> ./benchmark
docker-compse up --build
</code></pre></div><img src=/images/Prometheus.png class=img-fluid alt=prometheus.png><p class=edit-page><a href=https://github.com/open-privacy/opv/blob/main/docs/openprivacy.io/content/docs/overview/introduction.md><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit-2"><path d="M17 3a2.828 2.828.0 114 4L7.5 20.5 2 22l1.5-5.5L17 3z"/></svg>Edit this page on GitHub</a></p><div class="docs-navigation d-flex justify-content-between"><a class=ml-auto href=/docs/development/playground/><div class="card my-1"><div class="card-body py-2">Playground &rarr;</div></div></a></div></main></div></div></div><footer class="footer text-muted"><div class=container><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>@openprivacy.io</li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-right"><ul class=list-inline><li class=list-inline-item><a href=https://github.com/open-privacy/opv/discussions>Community Discussions</a></li></ul></div></div></div></footer><script src=/main.min.db67f0caa6a5788b691b9509981d6e5943f4b8d829170a674f468d4b23671ce4017c47a0a22116a8fc2f2de556c8b48f1afecd86707066f2f022c5dd83e8ea3c.js integrity="sha512-22fwyqaleItpG5UJmB1uWUP0uNgpFwpnT0aNSyNnHOQBfEegoiEWqPwvLeVWyLSPGv7NhnBwZvLwIsXdg+jqPA==" crossorigin=anonymous defer></script><script src=/index.min.6be298bfa59e4a95c0a465d371a5830a7485b7489a14e3c3cf2dba842af910b139459d76913f748f90c614fb0c20ea69cba6e7096fdcf96cac305fed29c8c5b6.js integrity="sha512-a+KYv6WeSpXApGXTcaWDCnSFt0iaFOPDzy26hCr5ELE5RZ12kT90j5DGFPsMIOppy6bnCW/c+WysMF/tKcjFtg==" crossorigin=anonymous defer></script></body></html>